import{_ as o,W as i,X as p,Y as n,Z as s,$ as e,a0 as t,H as l}from"./framework-5cecf6de.js";const c={},d=t('<h1 id="dbc-裸金属节点" tabindex="-1"><a class="header-anchor" href="#dbc-裸金属节点" aria-hidden="true">#</a> DBC 裸金属节点</h1><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><ol><li>DBC 的裸金属节点只负责为裸金属服务器生成 &quot;node_id&quot;, 控制裸金属服务器进行开关机等有限的操作。</li><li>裸金属节点不支持虚拟机相关功能，因为对部署节点的机器硬件设备要求很低，使用的内存硬盘等资源非常小，只要能对裸金属服务器使用 IPMI 工具且网络服务正常即可。</li></ol><div class="hint-container tip"><p class="hint-container-title">注意！</p><p>DBC 的裸金属节点本身有个 &quot;node_id&quot;，不需要上链，只用来为裸金属服务器生成 &quot;node_id&quot;。</p><p>例如向裸金属节点发送添加裸金属服务器的请求，参数需要告诉客户端节点发给哪个裸金属节点，并且填上用于 IPMI 控制的信息，请求会返回一个新的 &quot;node_id&quot;，即要添加的裸金属服务器的 &quot;node_id&quot;，这个 &quot;node_id&quot; 需要上链，然后用户才能在链上租用它，使用它发送开关机的请求。</p><p>本文提到两种 &quot;node_id&quot;，在此区分：</p><ul><li>“裸金属节点的 node_id”即节点安装目录下“dat/node.dat”文件中“node_id”字段。</li><li>“裸金属服务器的 node_id”即发送添加裸金属服务器的请求返回的“node_id”字段。</li></ul></div><h2 id="安装节点" tabindex="-1"><a class="header-anchor" href="#安装节点" aria-hidden="true">#</a> 安装节点</h2>',5),u={href:"http://112.192.16.27:9000/dbc/install_update_script/mainnet/install_baremetal.sh",target:"_blank",rel:"noopener noreferrer"},r=n("li",null,"运行安装脚本:",-1),v=t(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>sudo bash ./install_baremetal.sh 安装目录
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>安装脚本会自动安装 IPMI 工具，并且会像安装 DBC 客户端节点的脚本一样，需要输入 2 个端口号。</p><h2 id="升级节点" tabindex="-1"><a class="header-anchor" href="#升级节点" aria-hidden="true">#</a> 升级节点</h2>`,3),m={href:"http://112.192.16.27:9000/dbc/install_update_script/mainnet/update_baremetal.sh",target:"_blank",rel:"noopener noreferrer"},k=n("li",null,"运行升级脚本：",-1),b=t(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>sudo bash update_baremetal.sh 安装目录
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="添加裸金属服务器" tabindex="-1"><a class="header-anchor" href="#添加裸金属服务器" aria-hidden="true">#</a> 添加裸金属服务器</h2><ul><li><p>请求方式：POST</p></li><li><p>请求 URL：</p></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://{{dbc_client_ip}}:{{dbc_client_port}}/api/v1/bare_metal/add
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>请求 Body:</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;peer_nodes_list&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 裸金属节点的 node_id</span>
    <span class="token string">&quot;ccd9a2118ba3c95cd458302601f15281edc39d72dcf11a07527893d97ac1a573&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;additional&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 裸金属服务器的信息列表</span>
    <span class="token property">&quot;bare_metal_nodes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 机器供应商的识别裸金属的唯一ID，必填。</span>
        <span class="token property">&quot;uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3156995b-da18-4268-9734-f8d168e90a7d&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 裸金属服务器给用户提供的连接方式，必填。建议固定IP地址。</span>
        <span class="token property">&quot;ip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;175.221.204.110&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 裸金属服务器的操作系统，非必填。</span>
        <span class="token property">&quot;os&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ubuntu 20.04.3 LTS (Focal Fossa) 5.4.0-121-generic GNU/Linux&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 机器所有者自定义的描述，非必填。</span>
        <span class="token property">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;在xxx平台租用的裸金属服务器，用于xxx业务，机房id是9f01ca9c-38bd-46a9-9637-dac92b352a63&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ipmi的主机标识，必填。建议固定IP地址。</span>
        <span class="token property">&quot;ipmi_hostname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.168.0.110&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ipmi的用户名，必填。</span>
        <span class="token property">&quot;ipmi_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ipmi的用户密码，必填。</span>
        <span class="token property">&quot;ipmi_password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dbtu2017&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>返回示例：</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;errcode&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bare_metal_nodes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;node_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fcf2cd8b99958606d260ca00c5ac00c88c242bcf8eb38e7cc3f29e9719a73f39&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3156995b-da18-4268-9734-f8d168e90a7d&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查询裸金属服务器" tabindex="-1"><a class="header-anchor" href="#查询裸金属服务器" aria-hidden="true">#</a> 查询裸金属服务器</h2><ul><li><p>请求方式：POST</p></li><li><p>请求 URL：</p></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://{{dbc_client_ip}}:{{dbc_client_port}}/api/v1/bare_metal
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>请求 Body:</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;peer_nodes_list&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 裸金属节点的node_id</span>
    <span class="token string">&quot;ccd9a2118ba3c95cd458302601f15281edc39d72dcf11a07527893d97ac1a573&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;additional&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>返回示例：</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;errcode&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bare_metal_nodes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;node_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fcf2cd8b99958606d260ca00c5ac00c88c242bcf8eb38e7cc3f29e9719a73f39&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;node_private_key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4c2e7133834d6d7dd35088beda5556215f6f5b15d2cd3c3153f117aaeec2c28b&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3156995b-da18-4268-9734-f8d168e90a7d&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;175.221.204.110&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;os&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ubuntu 20.04.3 LTS (Focal Fossa) 5.4.0-121-generic GNU/Linux&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;在xxx平台租用的裸金属服务器，用于xxx业务，机房id是9f01ca9c-38bd-46a9-9637-dac92b352a63&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ipmi_hostname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.168.0.110&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ipmi_username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ipmi_password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dbtu2017&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="裸金属服务器上链" tabindex="-1"><a class="header-anchor" href="#裸金属服务器上链" aria-hidden="true">#</a> 裸金属服务器上链</h2>`,16),q={href:"https://deepbrainchain.github.io/DBC-Wiki/onchain-guide/bonding-machine.html",target:"_blank",rel:"noopener noreferrer"},_=t(`<p>上链后，就可以用像租用普通算力机器一样在链上租用裸金属服务器。</p><div class="hint-container tip"><p class="hint-container-title">注意！</p><p>裸金属服务器上链用到的 “node_id” 即添加裸金属服务器的请求返回的“node_id”，&quot;node_private_key&quot;则由上面的查询裸金属服务器获取。</p></div><h2 id="裸金属服务器的使用" tabindex="-1"><a class="header-anchor" href="#裸金属服务器的使用" aria-hidden="true">#</a> 裸金属服务器的使用</h2><p>在链上租用裸金属服务器，就可以查询到它的机器信息，使用机器信息中的 IP 和端口进行连接(ssh 或者 Windows 的远程连接工具)。</p><p>如果裸金属服务器没有开机，则可以通过发送请求控制其电源开机。</p><ul><li><p>请求方式：POST</p></li><li><p>请求 URL：</p></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://{{dbc_client_ip}}:{{dbc_client_port}}/api/v1/bare_metal/power
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>请求 Body:</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;peer_nodes_list&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 裸金属服务器的 node_id</span>
    <span class="token string">&quot;fcf2cd8b99958606d260ca00c5ac00c88c242bcf8eb38e7cc3f29e9719a73f39&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;additional&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 电源控制命令</span>
    <span class="token comment">// &quot;on&quot;     - 开机</span>
    <span class="token comment">// &quot;off&quot;    - 关机</span>
    <span class="token comment">// &quot;reset&quot;  - 重启</span>
    <span class="token comment">// &quot;status&quot; - 获取电源状态</span>
    <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;on&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;session_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;租用者分发的session_id&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;session_id_sign&quot;</span><span class="token operator">:</span> <span class="token string">&quot;租用者分发的session_id_sign&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9),h={href:"https://deepbrainchain.github.io/DBC-Wiki/install-update-dbc-node/dbc-client-api/http-api.html#%E8%A3%B8%E9%87%91%E5%B1%9E%E8%8A%82%E7%82%B9%E6%93%8D%E4%BD%9C",target:"_blank",rel:"noopener noreferrer"};function g(x,f){const a=l("ExternalLinkIcon");return i(),p("div",null,[d,n("ol",null,[n("li",null,[s("下载安装脚本："),n("a",u,[s("http://112.192.16.27:9000/dbc/install_update_script/mainnet/install_baremetal.sh"),e(a)])]),r]),v,n("ol",null,[n("li",null,[s("下载升级脚本："),n("a",m,[s("http://112.192.16.27:9000/dbc/install_update_script/mainnet/update_baremetal.sh"),e(a)])]),k]),b,n("p",null,[s('使用上面查询到的"node_id"和"node_private_key"，将裸金属服务器上链。参考'),n("a",q,[s("机器上链步骤"),e(a)])]),_,n("p",null,[s("其他 API 接口请参考"),n("a",h,[s("裸金属节点操作"),e(a)])])])}const B=o(c,[["render",g],["__file","dbc-bare-metal-node.html.vue"]]);export{B as default};
